<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TIL305 LED Pattern Designer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #1a1a1a;
            color: white;
        }
        
        h1 {
            text-align: center;
            color: #00ff00;
            margin-bottom: 30px;
        }
        
        .matrix-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 30px 0;
        }
        
        .matrix {
            display: grid;
            grid-template-columns: repeat(7, 40px);
            grid-template-rows: repeat(5, 40px);
            gap: 10px;
            padding: 20px;
            background-color: #333;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .led {
            width: 40px;
            height: 40px;
            border: 2px solid #666;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: #999;
        }
        
        .led.off {
            background-color: #222;
        }
        
        .led.on {
            background-color: #ff0000;
            border-color: #ff4444;
            box-shadow: 0 0 10px #ff0000;
        }
        
        .led:hover {
            border-color: #00ff00;
            transform: scale(1.1);
        }
        
        .decimal-point {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid #666;
            cursor: pointer;
            transition: all 0.2s;
            margin-left: 10px;
            align-self: flex-end;
            margin-bottom: 10px;
        }
        
        .decimal-point.off {
            background-color: #222;
        }
        
        .decimal-point.on {
            background-color: #ff0000;
            border-color: #ff4444;
            box-shadow: 0 0 10px #ff0000;
        }
        
        .decimal-point:hover {
            border-color: #00ff00;
            transform: scale(1.2);
        }
        
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        
        button {
            background-color: #333;
            color: white;
            border: 2px solid #666;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        
        button:hover {
            background-color: #555;
            border-color: #00ff00;
        }
        
        .code-output {
            background-color: #000;
            border: 2px solid #333;
            border-radius: 5px;
            padding: 15px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .matrix-display {
            display: flex;
            align-items: flex-end;
            justify-content: center;
        }
        
        .labels {
            margin: 10px 0;
            text-align: center;
            color: #888;
        }
    </style>
</head>
<body>
    <h1>ðŸ”´ TIL305 LED Pattern Designer</h1>
    
    <div class="labels">
        <p>Click LEDs to toggle them ON/OFF</p>
        <p>Columns: 1-7 (left to right) | Rows: 1-5 (top to bottom)</p>
    </div>
    
    <div class="matrix-container">
        <div class="matrix-display">
            <div class="matrix" id="ledMatrix">
                <!-- LEDs will be generated by JavaScript -->
            </div>
            <div class="decimal-point off" id="decimalPoint" title="Decimal Point"></div>
        </div>
    </div>
    
    <div class="controls">
        <button onclick="clearAll()">Clear All</button>
        <button onclick="setAll()">Set All</button>
        <button onclick="generateCode()">Generate Arduino Code</button>
        <button onclick="copyCode()">Copy Code</button>
    </div>
    
    <div class="code-output" id="codeOutput">
// Your Arduino code will appear here...
// Click "Generate Arduino Code" to create the pattern
    </div>

    <script>
        // LED matrix state (7 columns x 5 rows)
        let ledState = [];
        let decimalState = false;
        
        // Initialize matrix
        function initMatrix() {
            ledState = Array(5).fill().map(() => Array(7).fill(false));
            createLEDs();
        }
        
        // Create LED elements
        function createLEDs() {
            const matrix = document.getElementById('ledMatrix');
            matrix.innerHTML = '';
            
            for (let row = 0; row < 5; row++) {
                for (let col = 0; col < 7; col++) {
                    const led = document.createElement('div');
                    led.className = 'led off';
                    led.dataset.row = row;
                    led.dataset.col = col;
                    led.title = `Row ${row + 1}, Col ${col + 1}`;
                    led.textContent = `R${row + 1}C${col + 1}`;
                    
                    led.addEventListener('click', () => toggleLED(row, col));
                    matrix.appendChild(led);
                }
            }
            
            // Decimal point
            const decimal = document.getElementById('decimalPoint');
            decimal.addEventListener('click', toggleDecimal);
        }
        
        // Toggle individual LED
        function toggleLED(row, col) {
            ledState[row][col] = !ledState[row][col];
            updateDisplay();
        }
        
        // Toggle decimal point
        function toggleDecimal() {
            decimalState = !decimalState;
            updateDisplay();
        }
        
        // Update visual display
        function updateDisplay() {
            const leds = document.querySelectorAll('.led');
            leds.forEach(led => {
                const row = parseInt(led.dataset.row);
                const col = parseInt(led.dataset.col);
                led.className = ledState[row][col] ? 'led on' : 'led off';
            });
            
            const decimal = document.getElementById('decimalPoint');
            decimal.className = decimalState ? 'decimal-point on' : 'decimal-point off';
        }
        
        // Clear all LEDs
        function clearAll() {
            ledState = Array(5).fill().map(() => Array(7).fill(0));
            decimalState = false;
            updateDisplay();
        }
        
        // Set all LEDs
        function setAll() {
            ledState = Array(5).fill().map(() => Array(7).fill(1));
            decimalState = true;
            updateDisplay();
        }
        
        // Generate Arduino code
        function generateCode() {
            let code = `/*
--- WIRING ---
TIL305 -> MCU

Rows:
!!! Use 150R / 220R resistors!!!
IO0 -> pin 1 (row3)
IO1 -> pin 6 (row1)
IO2 -> pin 7 (row2)
IO3 -> pin 8 (row4)
IO4 -> pin 12 (row5)
IO5 -> pin 13 (row6)

Columns:
IO6 -> pin 2 (col7)
IO7 -> pin 3 (col6)
IO8 -> pin 4 (col5)
IO9 -> pin 11 (col2)
IO10 -> pin 10 (col1)
IO20 -> pin 5 (col3)
IO21 -> pin 9 (col4)
*/

// Pin definitions
const int rowPins[6] = { 1, 2, 0, 3, 4, 5 };        // Rows 1-6
const int colPins[7] = { 10, 9, 20, 21, 8, 7, 6 };  // Cols 1-7

// Matrix dimensions
const int COLS = 7;
const int ROWS = 5;

// Your custom pattern
bool pattern[5][7] = {
`;

            // Generate pattern array
            for (let row = 0; row < 5; row++) {
                code += '  { ';
                for (let col = 0; col < 7; col++) {
                    code += ledState[row][col] ? '1' : '0';
                    if (col < 6) code += ', ';
                }
                code += ' }';
                if (row < 4) code += ',';
                code += `  // Row ${row + 1}\n`;
            }

            code += `};

bool decimalOn = ${decimalState};

void setup() {
  // Set up row pins (active HIGH)
  for (int i = 0; i < 6; i++) {
    pinMode(rowPins[i], OUTPUT);
    digitalWrite(rowPins[i], LOW);
  }

  // Set up column pins (active LOW)
  for (int i = 0; i < COLS; i++) {
    pinMode(colPins[i], OUTPUT);
    digitalWrite(colPins[i], HIGH);
  }
}

void loop() {
  displayPattern();
}

void displayPattern() {
  // Multiplexing: scan through each row
  for (int row = 0; row < ROWS; row++) {
    // Turn off everything
    allOff();
    
    // Set column states for this row
    for (int col = 0; col < COLS; col++) {
      digitalWrite(colPins[col], pattern[row][col] ? LOW : HIGH);
    }
    
    // Turn on current row
    digitalWrite(rowPins[row], HIGH);
    
    delay(2); // Brief delay for persistence of vision
  }
  
  // Handle decimal point (row 6, col 6 - IO5, IO7)
  if (decimalOn) {
    allOff();
    digitalWrite(colPins[5], LOW);  // Col 6 (IO7)
    digitalWrite(rowPins[5], HIGH); // Row 6 (IO5) 
    delay(2);
  }
}`;

            document.getElementById('codeOutput').textContent = code;
        }
        
        // Copy code to clipboard
        function copyCode() {
            const code = document.getElementById('codeOutput').textContent;
            navigator.clipboard.writeText(code).then(() => {
                alert('Code copied to clipboard!');
            }).catch(() => {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = code;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('Code copied to clipboard!');
            });
        }
        
        // Initialize on page load
        initMatrix();
    </script>
</body>
</html>